<div class="border border-surface rounded-2xl flex flex-col md:flex-row">

    <!-- Left Container (Scrollable) -->
    <div class="w-full md:w-4/12 xl:w-3/12 min-w-40 flex flex-col gap-6 overflow-y-auto">
        <div class="flex flex-col gap-6 pt-3 pb-2 -mb-2 px-5 sticky top-0 bg-surface-0 dark:bg-surface-950 z-10">
            <div class="flex items-center justify-between gap-6 text-color">
                <div class="text-2xl font-medium lead">Tracking</div>
            </div>
        </div>
        <div class="px-5">
            <p-iconField iconPosition="left">
                <p-inputIcon class="pi pi-search"> </p-inputIcon>
                <input type="text" pInputText [(ngModel)]="search" placeholder="Search" class="w-full" />
            </p-iconField>
        </div>
        <div class="w-full px-5">
            <div class="flex flex-wrap gap-6 justify-center">
                <!-- Loop through statusCards and display icons with dynamic colors based on status -->
                 @for (card of statusCards; track $index) {
                     <div class="flex flex-col items-center">
                         <i [ngClass]="{
                             'text-green-500' : card.status === 'Running', 
                             'text-yellow-500' : card.status === 'Idle', 
                             'text-red-500' : card.status === 'Stopped',
                             'text-blue-500' : card.status === 'Total',
                             'text-gray-500' : card.status === 'Offline'
                         }" 
                         class="pi pi-map-marker cursor-pointer text-3xl hover:scale-105 transition-all duration-200"></i>
                         
                         <!-- Display the count below the icon -->
                         <div class="mt-2 text-sm text-muted-color font-medium">
                             {{ card.count }}
                         </div>
                     </div>
                 }
            </div>
        </div>

        <div class="flex-1 flex flex-col max-h-[calc(100vh-250px)] overflow-y-auto shadow-sm divide-y divide-surface-200 dark:divide-surface-800">
            @for (vehicle of vehicleList; track $index) {
                <div (click)="activeVehicle = vehicle.vehicleNo" class="flex items-center gap-2 p-4 cursor-pointer hover:bg-emphasis transition-all" [ngClass]="{
                    'bg-emphasis': vehicle.vehicleNo === activeVehicle
                }">
                    <div class="relative">
                        <p-avatar [label]="'V' + ($index + 1)" styleClass="text-base font-medium flex" size="large" shape="circle" />
                    </div>
                    
                    <div class="flex-1">
                        <div class="flex items-start gap-1 justify-between">
                            <div class="text-color font-medium leading-6">{{ vehicle.vehicleNo }}</div>
                            <p-tag [severity]="vehicle.severity" [value]="vehicle.vehicleStatus" />
                            <!-- <div class="text-sm text-muted-color leading-5">{{ vehicle.vehicleStatus }}</div> -->
                        </div>
                        <div class="flex items-center gap-5 justify-between mt-1">
                            <div class="text-muted-color text-sm leading-5 line-clamp-1">
                                {{ vehicle.vehicleDuration }}
                            </div>
                        </div>
                    </div>
                </div>
            }
        </div>
    </div>

    <!-- Right Container (Map Section, Fixed) -->
    <div class="w-full md:w-full border-x border-surface p-3">
        <div class="h-[90vh] relative">
            <!-- Ensure Leaflet container inherits full height/width -->
            <div
                class="absolute inset-0"
                leaflet
                [leafletOptions]="mapOptions"
                (leafletMapReady)="onMapReady($event)">
            </div>
        </div>
    </div>

</div>